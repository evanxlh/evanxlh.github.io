<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="baidu-site-verification" content="xl7Ck2KCfm" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="description" content="æˆ‘çš„ä¸ªäººåšå®¢">
    <meta name="keyword"  content="Evan, çˆ±é—®, åŸƒæ–‡, åšå®¢, iOS Developer, è½¯ä»¶å·¥ç¨‹å¸ˆ, ç¨‹åºå‘˜, Evançš„åšå®¢, evanxlh, Evan ç¨‹åºäººç”Ÿ">
    <link rel="shortcut icon" href="/img/green-life.jpg">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!--<link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>-->
    <title>
        
          iOS app é‡ç­¾ååŠå‘å¸ƒè‡³ AppStore - evanxlh
        
    </title>

    <link rel="canonical" href="https://evanxlh.github.io/2020/05/28/ios-app-resigning/">

    <!-- Bootstrap Core CSS -->
    
<link rel="stylesheet" href="/css/bootstrap.min.css">


    <!-- Custom CSS --> 
    
        
<link rel="stylesheet" href="/css/dusign-light.css">

        
<link rel="stylesheet" href="/css/dusign-common-light.css">

        
<link rel="stylesheet" href="/css/font-awesome.css">

        
<link rel="stylesheet" href="/css/toc.css">

        <!-- background effects end -->
    
    
    <!-- Pygments Highlight CSS -->
    
<link rel="stylesheet" href="/css/highlight.css">


    
<link rel="stylesheet" href="/css/widget.css">


    
<link rel="stylesheet" href="/css/rocket.css">


    
<link rel="stylesheet" href="/css/signature.css">


    
<link rel="stylesheet" href="/css/fonts.googleapis.css">


    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">

    <!-- photography -->
    
<link rel="stylesheet" href="/css/photography.css">


    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 4.2.0"></head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- background effects start -->
    
    <!-- background effects end -->

	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            
                background-image: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)), url('../../../../img/default-post.jpg')
                /*post*/
            
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#Appæ„å»ºä¸å‘å¸ƒ" title="Appæ„å»ºä¸å‘å¸ƒ">Appæ„å»ºä¸å‘å¸ƒ</a>
                            
                        </div>
                        <h1>iOS app é‡ç­¾ååŠå‘å¸ƒè‡³ AppStore</h1>
                        <h2 class="subheading">ä»£ç ç­¾ååŸç†ï¼Œipa, xcarchive è„šæœ¬ä¸€é”®é‡ç­¾åï¼Œå°½åœ¨è¿™é‡Œ</h2>
                        <span class="meta">
                            2020-05-28, evanxlh
                        </span>

                        
                            <div class="blank_box"></div>
                            <span class="meta">
                                å­—æ•°: <span class="post-count">4.2k</span>, 
                                é˜…è¯»æ—¶é—´: <span class="post-count">16</span> 
                                åˆ†é’Ÿ
                            </span>
                            <div class="blank_box"></div>
                            <!-- ä¸è’œå­ç»Ÿè®¡ start -->
                            <span class="meta">
                                æµè§ˆæ¬¡æ•°: <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>
                            </span>
                            <!-- ä¸è’œå­ç»Ÿè®¡ end -->
                        

                    </div>
                

                </div>
            </div>
        </div>      
    </div>

    
    <div class="waveWrapper">
        <div class="wave wave_before" style="background-image: url('/img/wave-light.png')"></div>
        <div class="wave wave_after" style="background-image: url('/img/wave-light.png')"></div>
    </div>
    
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!-- <a class="navbar-brand" href="/">evanxlh</a> -->
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">ä¸»é¡µ</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/archive/">å½’æ¡£</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/about/">å…³äº</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/categories/">åˆ†ç±»</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/photography/">æ‘„å½±</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">æ ‡ç­¾</a>
                        </li>
                        
                    
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h1 id="iOS-app-é‡ç­¾ååŠå‘å¸ƒè‡³-AppStore"><a href="#iOS-app-é‡ç­¾ååŠå‘å¸ƒè‡³-AppStore" class="headerlink" title="iOS app é‡ç­¾ååŠå‘å¸ƒè‡³ AppStore"></a>iOS app é‡ç­¾ååŠå‘å¸ƒè‡³ AppStore</h1><p>ç”±äºå…¬å¸æœ‰ä¸ªé¡¹ç›®è¯·äº†å¤–åŒ…å›¢é˜Ÿæ¥å¼€å‘ï¼Œä½†ä¸æä¾›æºç ï¼Œåªæä¾› xcarchive æˆ– ipa åŒ…ï¼Œè€Œåšä¸ºå…¬å¸åˆä¸å¯èƒ½å°†è¯ä¹¦åŠç§é’¥å‘ç»™å¤–åŒ…å›¢é˜Ÿï¼Œè®©ä»–ä»¬æ¥æ‰“åŒ…ã€‚æ‰€ä»¥é‡ç­¾åå°±æ˜¯ç»•ä¸è¿‡çš„åäº†ï¼Œåªèƒ½è‡ªå·±æ¥åšè¿™ä¸€å·¥ä½œäº†ã€‚åˆšå¼€å§‹ç›´æ¥ä»ç½‘ä¸Šæ‰¾èµ„æ–™ï¼Œç›´æ¥ç”¨ç°æˆçš„è„šæœ¬ä½œäº›ä¿®æ”¹æ¥è¿›è¡Œé‡ç­¾åï¼Œå¯éƒ½ä¼šå‡ºç°å„ç§é—®é¢˜ã€‚æ— è€ä¹‹ä¸‹ï¼Œåªèƒ½ç¿»é˜…è‹¹æœå®˜ç½‘æ–‡æ¡£ä»¥åŠ <I>Troubleshooting</I>ï¼Œæœ€ç»ˆå®Œæˆé‡ç­¾åï¼Œå¹¶ä¸Šä¼ è‡³ AppStoreã€‚ç°åœ¨å°†é‡ç­¾åè¿‡ç¨‹é‡æ–°æ•´ç†ä¸‹ï¼Œè®°å½•ä¸‹æ¥æ–¹ä¾¿ä»¥åæŸ¥é˜…ï¼Œä¹Ÿå¸Œæœ›èƒ½å¸®åŠ©åˆ°æœ‰éœ€è¦çš„åŒå­¦ä»¬ã€‚</p>
<h2 id="æ ¸å¿ƒæ¦‚å¿µ"><a href="#æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="æ ¸å¿ƒæ¦‚å¿µ"></a>æ ¸å¿ƒæ¦‚å¿µ</h2><p>ä»£ç ç­¾å(<I>Code Signing</I>)æ˜¯æ“ä½œç³»ç»Ÿåº”ç”¨çš„ä¸€ç§å®‰å…¨æŠ€æœ¯ï¼Œç”¨æ¥è¯æ˜ app æ˜¯ä½ åˆ›å»ºçš„ã€‚ä¸€æ—¦ app è¢«ç­¾ååï¼Œæ“ä½œç³»ç»Ÿå°±å¯ä»¥æ£€æµ‹å‡º App æ˜¯å¦è¢«æ„å¤–æˆ–æ¶æ„åœ°ä¿®æ”¹è¿‡ï¼Œæ˜¯å¦æ¥è‡ªä¸€ä¸ªå—ä¿¡ä»»çš„å‘å¸ƒæœºæ„æˆ–ç»„ç»‡ï¼Œæˆ–ä¸ªäººã€‚ä»£ç ç­¾åæœ€åŸºç¡€ã€æœ€æ ¸å¿ƒéƒ¨åˆ†å°±æ˜¯æ•°æ®çš„åŠ å¯†å“ˆå¸Œå‡½æ•°å’Œéå¯¹ç§°åŠ å¯†ï¼Œç„¶ååœ¨æ­¤åŸºç¡€ä¸Šï¼Œå®šä¹‰ä¸€äº›è§„åˆ™ä¸ç­–ç•¥ï¼Œæ¥å®Œæˆä»£ç ç­¾åã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸‹ç­¾åç›¸å…³çš„ä¸€äº›æ ¸å¿ƒæ¦‚å¿µã€‚</p>
<h4 id="åŠ å¯†å“ˆå¸Œå‡½æ•°"><a href="#åŠ å¯†å“ˆå¸Œå‡½æ•°" class="headerlink" title="åŠ å¯†å“ˆå¸Œå‡½æ•°"></a>åŠ å¯†å“ˆå¸Œå‡½æ•°</h4><p>åŠ å¯†å“ˆå¸Œå‡½æ•°å¯ä»¥æ¥æ”¶ä»»æ„å¤§å°çš„æ•°æ®ï¼Œç„¶ååº”ç”¨ç‰¹å®šç®—æ³•å¤„ç†è¾“å…¥æ•°æ®ï¼Œå¹¶è¾“å‡ºå›ºå®šå¤§å°çš„å“ˆå¸Œæ•°æ®(å¦‚128 / 256 ä½ç­‰)ã€‚ä¸€äº›å¸¸è§çš„å“ˆå¸Œç®—æ³•æœ‰ <I>SHA-1, SHA-2</I> ç­‰ç­‰ã€‚åœ¨ä»£ç ç­¾åè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥ç”Ÿæˆä»£ç æ•°æ®çš„ä¿¡æ¯æ‘˜è¦(<I>message digest</I>, Apple ç§°å®ƒä¸º <I>seal</I>, å³å°æ¡ï¼Œç”¨æ¥éªŒè¯æ•°æ®æ˜¯å¦è¢«æ›´æ”¹)ã€‚</p>
<h4 id="éå¯¹ç§°åŠ å¯†"><a href="#éå¯¹ç§°åŠ å¯†" class="headerlink" title="éå¯¹ç§°åŠ å¯†"></a>éå¯¹ç§°åŠ å¯†</h4><p><a href="https://en.wikipedia.org/wiki/Public-key_cryptography" target="_blank" rel="noopener">éå¯¹ç§°åŠ å¯†</a>(<I>public key cryptography, æˆ–è€… asymmetric cryptography</I>) æä¾›ä¸¤ç»„å¯†é’¥ï¼šå…¬é’¥å’Œç§é’¥ã€‚å…¬é’¥å¯ä»¥å…¬å¼€å¹¶åˆ†äº«ç»™ä»–äººï¼Œè€Œç§é’¥åªèƒ½è‡ªå·±æ‹¥æœ‰ã€‚å…¬ç§°å’Œç§é’¥éƒ½å¯ä»¥ç”¨æ¥åŠ è§£å¯†ï¼Œä½†åœ¨ä¸€æ¬¡åŠ å¯†è§£å¯†è¿‡ç¨‹ä¸­ï¼Œéœ€è¦é…å¯¹ä½¿ç”¨ã€‚ä¸ç®¡æ˜¯ç”¨å…¬é’¥åŠ å¯†ï¼Œè¿˜æ˜¯ç§é’¥åŠ å¯†ï¼Œæœ€åé€šè¿‡è§£å¯†åï¼Œéƒ½èƒ½è¿˜åŸå‡ºæ˜æ–‡ï¼Œæ­£å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://gitee.com/evanxlh/Resources/raw/master/blog/ios-app-resigning/security-asymmetric.jpg" alt="Security Asymmetric">  </p>
<h4 id="ä¿¡æ¯æ‘˜è¦"><a href="#ä¿¡æ¯æ‘˜è¦" class="headerlink" title="ä¿¡æ¯æ‘˜è¦"></a>ä¿¡æ¯æ‘˜è¦</h4><p>ä¿¡æ¯æ‘˜è¦(<I>message digest</I>)æ˜¯ç”±ä»£ç ç­¾åè½¯ä»¶åˆ›å»ºçš„ä»£ç å„ä¸ªéƒ¨åˆ†çš„æ ¡éªŒå’Œæˆ–å“ˆå¸Œçš„é›†åˆï¼Œå¯ä»¥ç”¨æ¥æ£€æµ‹æ•°æ®æ˜¯å¦è¢«æ›´æ”¹ã€‚ æ‹¿å†™ä¹¦ä¿¡ä¸ºä¾‹ï¼Œå†™å¥½çš„ä¹¦ä¿¡æ”¾å…¥ä¿¡å°ï¼Œç„¶åè¿›è¡Œå¯†å°ã€‚å¦‚æœæ”¶ä¿¡äººå‘ç°å¯†å°æŸåï¼Œä»–å°±ä¼šçŸ¥é“è¿™å°ä¿¡è‚¯å®šè¢«æ‰“å¼€è¿‡æˆ–è¢«ä»–äººåŠ¨è¿‡æ‰‹è„šã€‚æ‰€ä»¥ Apple ä¹Ÿç§°å®ƒä¸º <I>seal</I>ï¼Œæ„ä¸ºå¯†å°æˆ–å°æ¡ã€‚é€šè¿‡ç§é’¥åŠ å¯†åï¼Œå°±æˆäº†ä»£ç ç­¾åä¸­çš„åŠ å¯†ä¿¡æ¯æ‘˜è¦(<I>encrypted message digest</I>, æˆ–è€… <I>encrypted seal</I>)ã€‚  </p>
<h4 id="æ•°å­—è¯ä¹¦"><a href="#æ•°å­—è¯ä¹¦" class="headerlink" title="æ•°å­—è¯ä¹¦"></a>æ•°å­—è¯ä¹¦</h4><p>æ•°å­—è¯ä¹¦(<I>Digital Certificate</I>) æ˜¯ç”¨äºéªŒè¯æ•°å­—è¯ä¹¦ <I>æŒæœ‰è€…æˆ–å‘é€è€…</I> çš„èº«ä»½çš„æ•°æ®é›†åˆï¼Œæ¥è¯æ˜ç­¾åè€…å…¬é’¥çš„çœŸå®æ€§ã€‚æ¯”å¦‚  X.509 è¯ä¹¦åŒ…å«ä»¥ä¸‹ä¸€äº›ä¿¡æ¯: </p>
<ul>
<li>ç»“æ„ä¿¡æ¯: ç‰ˆæœ¬ï¼Œåºåˆ—å·ï¼Œç”¨äºåˆ›å»ºç­¾åçš„æ¶ˆæ¯æ‘˜è¦ç®—æ³•ç­‰</li>
<li>è¯ä¹¦é¢å‘æœºæ„çš„æ•°å­—ç­¾å</li>
<li>æœ‰å…³è¯ä¹¦æŒæœ‰è€…çš„ä¿¡æ¯: åç§°ï¼Œç”µå­é‚®ä»¶åœ°å€ï¼Œå…¬å¸åç§°ï¼Œæ‰€æœ‰è€…çš„å…¬é’¥ç­‰</li>
<li>æœ‰æ•ˆæœŸ: è¯ä¹¦åœ¨æ­¤æœŸé™ä¹‹å‰æˆ–ä¹‹åæ— æ•ˆ</li>
<li>è¯ä¹¦æ‰©å±•: åŒ…å«å…¶ä»–ä¿¡æ¯çš„å±æ€§ï¼Œå¦‚è¯ä¹¦çš„å…è®¸ç”¨é€”<br><img src="https://gitee.com/evanxlh/Resources/raw/master/blog/ios-app-resigning/anatomy-of-digital-certificate.png" alt="Digital Certificate" style="zoom:70%;" /><br>ä¸‹å›¾ä¸º <I>Apple Worldwide Developer Relations Certification Authority</I> è¯ä¹¦ä¸­æ‰€åŒ…å«çš„ä¿¡æ¯ï¼š<br><img src="https://gitee.com/evanxlh/Resources/raw/master/blog/ios-app-resigning/certificate-apple.png" alt="Apple Worldwide Developer Relations Certification Authority" style="zoom:67%;" /></li>
</ul>
<h4 id="æ•°å­—èº«ä»½"><a href="#æ•°å­—èº«ä»½" class="headerlink" title="æ•°å­—èº«ä»½"></a>æ•°å­—èº«ä»½</h4><p>æ•°å­—èº«ä»½(<I>Digital Identity</I>) æ˜¯å…¬é’¥-ç§é’¥å¯¹ä»¥åŠå¯¹åº”çš„æ•°å­—è¯ä¹¦çš„ç»„åˆã€‚å½“æˆ‘ä»¬å‘è‹¹æœç”³è¯·åˆ°ç­¾åè¯ä¹¦åï¼Œå¯¼å…¥åˆ° KeyChain Access ä¸­ï¼Œæˆ‘ä»¬å°±è·å–åˆ°äº†æ•°å­—èº«ä»½ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:<br><img src="https://gitee.com/evanxlh/Resources/raw/master/blog/ios-app-resigning/digital-identity.jpg" alt="Digital Identity"></p>
<h4 id="è¯ä¹¦é¢å‘æœºæ„"><a href="#è¯ä¹¦é¢å‘æœºæ„" class="headerlink" title="è¯ä¹¦é¢å‘æœºæ„"></a>è¯ä¹¦é¢å‘æœºæ„</h4><p>è¯ä¹¦é¢å‘æœºæ„(Certification Authority) æ˜¯é¢å‘æ•°å­—è¯ä¹¦çš„äººå‘˜æˆ–ç»„ç»‡ï¼Œå®ƒç¡®ä¿æ•°å­—è¯ä¹¦æ²¡æœ‰è¢«æ›´æ”¹ï¼Œå¹¶ä¸”è¡¨æ˜é¢å‘æ•°å­—è¯ä¹¦è€…çš„èº«ä»½ã€‚å¦‚ Appleï¼Œ æˆ‘ä»¬å¯ä»¥ä» Apple æä¾›çš„å·¥å…·æ¥åˆ›å»ºæ•°å­—èº«ä»½(<I>Digital Identity</I>)ï¼Œå¹¶ç”³è¯·æ•°å­—è¯ä¹¦ã€‚</p>
<h4 id="æ•°å­—ç­¾å"><a href="#æ•°å­—ç­¾å" class="headerlink" title="æ•°å­—ç­¾å"></a>æ•°å­—ç­¾å</h4><p>æ•°å­—ç­¾å(<I>Digital Signatures</I>) å°±æ˜¯åŠ å¯†ä¿¡æ¯æ‘˜è¦åŠæ•°å­—è¯ä¹¦çš„ç»„åˆï¼Œæ˜¯ä¸€ç§ä½¿ç”¨éå¯¹ç§°åŠ å¯†æ¥ä¿è¯æ•°æ®å®Œæ•´æ€§çš„æ–¹æ³•ã€‚å®ƒå¯ä»¥ç”¨æ¥éªŒè¯æ•°æ®ç­¾åè€…çš„èº«ä»½ï¼Œè·Ÿæˆ‘ä»¬ä½¿ç”¨ä¼ ç»Ÿç­¾å(ç”¨å¢¨æ°´åœ¨çº¸ä¸Šå†™ä¸Šè‡ªå·±çš„åå­—)æ–¹æ³•ä¸€æ ·ï¼Œéƒ½æ˜¯ç”¨æ¥è¡¨æ˜åŠéªŒè¯èº«ä»½çš„ã€‚ä½†æ•°å­—ç­¾åé™¤äº†èº«ä»½éªŒè¯å¤–ï¼Œè¿˜èƒ½æ£€æŸ¥å‡ºæ•°æ®æ˜¯å¦è¢«ä¿®æ”¹è¿‡ã€‚</p>
<h4 id="è§„èŒƒè¦æ±‚"><a href="#è§„èŒƒè¦æ±‚" class="headerlink" title="è§„èŒƒè¦æ±‚"></a>è§„èŒƒè¦æ±‚</h4><p><I>Code Requirements</I>ï¼Œæˆ‘å°±è¯‘æˆè§„èŒƒè¦æ±‚å§ï¼Œæ˜¯æ“ä½œç³»ç»Ÿç”¨æ¥è¯„ä¼°ä»£ç ç­¾åçš„è§„åˆ™ã€‚è¿›è¡Œè¯„ä¼°çš„ç³»ç»Ÿæ ¹æ®å…¶ç›®æ ‡å†³å®šåœ¨è¯„ä¼°æ—¶è¦åº”ç”¨å“ªäº›è¦æ±‚ã€‚æ¯”å¦‚ macos çš„ <I>Gatekeeper</I> æœ‰ä¸€ä¸ªè§„åˆ™ï¼Œå³åœ¨é¦–æ¬¡å…è®¸å¯åŠ¨åº”ç”¨ç¨‹åºä¹‹å‰ï¼Œå¿…é¡»ç”±Mac App Storeæˆ–å¼€å‘äººå‘˜IDè¯ä¹¦ç­¾åã€‚å†æ¯”å¦‚ä¸€ä¸ªåº”ç”¨ç¨‹åºå¯ä»¥å¼ºåˆ¶æ‰§è¡Œä¸€ä¸ªè§„èŒƒè¦æ±‚ï¼Œå³è¯¥åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ‰€æœ‰æ’ä»¶å‡åº”ç”± Apple ç­¾åã€‚æœ‰å…³è§„èŒƒçš„è¯¦ç»†æè¿°ï¼Œå¯ä»¥æŸ¥çœ‹<a href="https://developer.apple.com/library/archive/documentation/Security/Conceptual/CodeSigningGuide/AboutCS/AboutCS.html#//apple_ref/doc/uid/TP40005929-CH3-SW2" target="_blank" rel="noopener">è‹¹æœå®˜æ–¹ Code Requirements</a>ã€‚</p>
<h2 id="æ•°å­—ç­¾ååŸç†"><a href="#æ•°å­—ç­¾ååŸç†" class="headerlink" title="æ•°å­—ç­¾ååŸç†"></a>æ•°å­—ç­¾ååŸç†</h2><h3 id="æ•°å­—ç­¾åè¿‡ç¨‹"><a href="#æ•°å­—ç­¾åè¿‡ç¨‹" class="headerlink" title="æ•°å­—ç­¾åè¿‡ç¨‹"></a>æ•°å­—ç­¾åè¿‡ç¨‹</h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡å›¾ä¾‹æ¥é˜è¿°å•ä¸ªæ•°æ®(è¿™é‡ŒæŒ‡ä¸€ä¸ªæ–‡ä»¶)çš„æ•°å­—ç­¾åçš„è¿‡ç¨‹ï¼š </p>
<ol>
<li>ç­¾åè€…ä½¿ç”¨åŠ å¯†å“ˆå¸Œç®—æ³•ï¼Œç”Ÿæˆä¿¡æ¯æ‘˜è¦</li>
<li>ä½¿ç”¨ç§é’¥å¯¹ä¿¡æ¯æ‘˜è¦è¿›è¡ŒåŠ å¯†</li>
<li>å°†åŠ å¯†çš„ä¿¡æ¯æ‘˜è¦ã€æœ‰å…³ç­¾åè€…æ•°å­—è¯ä¹¦çš„ä¿¡æ¯ï¼Œä»¥åŠæ•°æ®æœ¬èº«æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œå®Œæˆæ•°å­—ç­¾å<br><img src="https://gitee.com/evanxlh/Resources/raw/master/blog/ios-app-resigning/code-signing.png" alt="Digital Signatures Process"> </li>
</ol>
<p><img src="https://gitee.com/evanxlh/Resources/raw/master/blog/ios-app-resigning/signing-doc.png" alt="a" style="zoom:60%;" /></p>
<h3 id="éªŒè¯æ•°å­—ç­¾åè¿‡ç¨‹"><a href="#éªŒè¯æ•°å­—ç­¾åè¿‡ç¨‹" class="headerlink" title="éªŒè¯æ•°å­—ç­¾åè¿‡ç¨‹"></a>éªŒè¯æ•°å­—ç­¾åè¿‡ç¨‹</h3><p>æ¯”å¦‚æˆ‘ä»¬å¯¹ä¸€ä¸ªæ–‡æ¡£è¿›è¡Œäº†æ•°æ®ç­¾åï¼Œé‚£æ¥æ”¶è€…å¦‚ä½•å»éªŒè¯æ•°å­—ç­¾åçš„æ­£ç¡®æ€§å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬ç»“åˆå›¾ä¾‹æ¥é˜è¿°ä¸‹éªŒè¯çš„è¿‡ç¨‹ï¼š </p>
<ol>
<li>æ¥æ”¶è€…ä»ç­¾åè€…çš„è¯ä¹¦ä¸­è·å–ç­¾åè€…çš„å…¬é’¥</li>
<li>ä½¿ç”¨å…¬é’¥å¯¹åŠ å¯†ä¿¡æ¯æ‘˜è¦è¿›è¡Œè§£å¯†</li>
<li>æ¥æ”¶è€…ä½¿ç”¨è¯ä¹¦ä¸­æŒ‡å®šçš„ç®—æ³•åˆ›å»ºæ•°æ®çš„æ–°çš„ä¿¡æ¯æ‘˜è¦</li>
<li>å°†æ–°çš„ä¿¡æ¯æ‘˜è¦ä¸æ•°å­—ç­¾åä¸­ä¼ é€’çš„ä¿¡æ¯æ‘˜è¦çš„è§£å¯†å‰¯æœ¬è¿›è¡Œæ¯”è¾ƒã€‚ å¦‚æœå®ƒä»¬åŒ¹é…ï¼Œåˆ™æ¥æ”¶åˆ°çš„æ•°æ®è‚¯å®šäºç­¾åè€…åˆ›å»ºçš„åŸå§‹æ•°æ®ç›¸åŒã€‚<br><img src="https://gitee.com/evanxlh/Resources/raw/master/blog/ios-app-resigning/verify-signature.png" alt="Verify digital signature" style="zoom:60%;" /></li>
</ol>
<h2 id="iOS-App-ä»£ç ç­¾å"><a href="#iOS-App-ä»£ç ç­¾å" class="headerlink" title="iOS App ä»£ç ç­¾å"></a>iOS App ä»£ç ç­¾å</h2><p>iOS ä»£ç ç­¾åæ¯”ä¹‹å‰æåˆ°çš„<a href="###æ•°å­—ç­¾åè¿‡ç¨‹">æ•°å­—ç­¾åè¿‡ç¨‹</a>ä¼šå¤æ‚ä¸€äº›ï¼Œåœ¨ç­¾åè¿‡ç¨‹ä¸­ï¼Œè¿˜éœ€è¦åŠ å…¥ <I>Provisioning Profile</I>ï¼Œå¹¶ä¸”è¦å¯¹å„ç§ä»£ç æ–‡ä»¶åˆ†åˆ«è¿›è¡Œæ•°å­—ç­¾åã€‚</p>
<h3 id="éœ€è¦å¯¹å“ªäº›æ–‡ä»¶ç­¾å"><a href="#éœ€è¦å¯¹å“ªäº›æ–‡ä»¶ç­¾å" class="headerlink" title="éœ€è¦å¯¹å“ªäº›æ–‡ä»¶ç­¾å"></a>éœ€è¦å¯¹å“ªäº›æ–‡ä»¶ç­¾å</h3><p>iOS app æœ‰ä¸‰ç±»æ–‡ä»¶éœ€è¦ç­¾å: </p>
<ul>
<li><p><strong>å†…åµŒä»£ç  (<I>Nested code</I>)</strong><br>åŒ…æ‹¬æ‰€æœ‰çš„æ‰“åŒ…åœ¨ App å†…çš„ libraries, frameworks, helpers, toolsï¼Œ ä»¥åŠ app ä¾èµ–çš„å…¶å®ƒç»„ä»¶ã€‚<font color=red>æ³¨æ„é™æ€åº“è¯·ä¸è¦å†…åµŒï¼Œå¦åˆ™é‡ç­¾ååçš„ ipa æ–‡ä»¶ä¸Šä¼ åˆ° iTunes Connect ä¼šæŠ¥é”™ã€‚</font></p>
</li>
<li><p><strong>Mach-O å¯æ‰§è¡Œæ–‡ä»¶ (<I>Mach-O executables</I>)</strong><br>ç­¾åè½¯ä»¶ä¼šå°†ç­¾åä¿¡æ¯ç›´æ¥å†™å…¥å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚å¯æ‰§è¡Œæ–‡ä»¶åŒ…æ‹¬ App å¯æ‰§è¡Œæ–‡ä»¶ å’Œ å†…åµŒçš„ Framework ä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>
</li>
<li><p><strong>èµ„æºæ–‡ä»¶ (<I>Resources</I>)</strong><br>é™¤äº†ä»£ç åŠå¯æ‰§è¡Œæ–‡ä»¶ä»¥å¤–çš„æ–‡ä»¶éƒ½å±äºèµ„æºæ–‡ä»¶ï¼Œéƒ½éœ€è¦è¿›è¡Œç­¾åã€‚æ¯ä¸ªèµ„æºæ–‡ä»¶ç­¾å®Œååï¼Œç­¾åä¿¡æ¯ä¼šè¢«è®°å½• <a href="###CodeResources">CodeResoures</a> ä¸­ï¼Œå­˜æ”¾åœ¨ <code>_CodeSignature</code> ç›®å½•ä¸‹ã€‚App ä¸­å¯èƒ½ä¼šæœ‰å¤šä¸ª <code>_CodeSignature</code> ç›®å½•ï¼Œå› ä¸º App çš„ <I> main bundle</I> ä¸­å¯èƒ½åŒ…å«æœ‰å†…åµŒ <I>framework bundle</I>, æˆ–è€…å…¶å®ƒçš„ <I>resource bundle</I>ã€‚</p>
</li>
</ul>
<h3 id="Entitlements"><a href="#Entitlements" class="headerlink" title="Entitlements"></a>Entitlements</h3><p>æƒé™æ–‡ä»¶æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ <em>plist</em> æ–‡ä»¶ï¼Œå¯ä»¥è¢«è®¤ä¸ºæ˜¯å†™å…¥åº”ç”¨ç­¾åä¸­çš„å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²å…è®¸ç‰¹å®šåŠŸèƒ½æˆ–ä½¿è¯¥åº”ç”¨é€‰æ‹©ç‰¹å®šæœåŠ¡ã€‚ æ“ä½œç³»ç»Ÿåœ¨å…è®¸åº”ç”¨è®¿é—®æŸäº›åŠŸèƒ½ä¹‹å‰ä¼šæ£€æŸ¥è¿™äº›å­—ç¬¦ä¸²ã€‚ æ¯”å¦‚ï¼Œåœ¨å…è®¸åº”ç”¨ç¨‹åºåœ¨è¿è¡Œæ—¶è®¿é—® Wi-Fi ä¿¡æ¯ä¹‹å‰ï¼Œè¯¥åº”ç”¨ç¨‹åºå¿…é¡»å…·æœ‰ <em>Wi-Fi Info</em> æƒåˆ©ã€‚ å…³äº <em>Entitlements</em> æ›´å¤šçš„è¯¦ç»†ä¿¡æ¯ï¼Œ<a href="https://developer.apple.com/library/archive/technotes/tn2318/_index.html#//apple_ref/doc/uid/DTS40013777-CH1-TNTAG33" target="_blank" rel="noopener">è¯·ç‚¹è¿™é‡Œ</a>ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">plist</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//Apple//DTD PLIST 1.0//EN"</span> <span class="meta-string">"http://www.apple.com/DTDs/PropertyList-1.0.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">"1.0"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">key</span>&gt;</span>application-identifier<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">string</span>&gt;</span>AA11BB22CC.com.company.appresignature.test<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">key</span>&gt;</span>beta-reports-active<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.developer.networking.wifi-info<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.developer.team-identifier<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">string</span>&gt;</span>AA11BB22CC<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">key</span>&gt;</span>get-task-allow<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">false</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">key</span>&gt;</span>keychain-access-groups<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">string</span>&gt;</span>AA11BB22CC.*<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Provisioning-Profile"><a href="#Provisioning-Profile" class="headerlink" title="Provisioning Profile"></a>Provisioning Profile</h3><p><I>Provisioning Profile</I> æ˜¯ä¸€ç§ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼Œå¯è®©æ‚¨åœ¨iOSè®¾å¤‡æˆ–Macä¸Šå®‰è£…åº”ç”¨ç¨‹åºï¼Œç”¨äºåœ¨è®¾å¤‡ä¸Šå¯åŠ¨ä¸€ä¸ªæˆ–å¤šä¸ªåº”ç”¨ç¨‹åºå¹¶ä½¿ç”¨æŸäº›æœåŠ¡ã€‚</p>
<p><I>Provisioning Profile</I> æ–‡ä»¶åŒ…å«ç­¾åè¯ä¹¦ã€app bundle IDã€Entitlements ä¿¡æ¯ï¼Œæˆ–è€… deivce idsï¼Œä¸è¿‡ <I>Provisioning Profile</I> å¯ä»¥åˆ†ä¸º <I>Development / Distribution</I> ç±»å‹ï¼Œè€Œ <I>Distribution</I> åˆåˆ†ä¸º <I>AppStore / AdHoc / Inhouse</I> / Developer IDã€‚æ¯ç§ç±»å‹çš„ <I>Provisioning Profile</I> åŒ…å«çš„ä¿¡æ¯éƒ½æœ‰äº›ä¸ä¸€æ ·ï¼Œä¸‹å›¾ä¸º AppStore <I>Provisioning Profile</I> åŒ…å«çš„ä¿¡æ¯ï¼š</p>
<p><img src="https://gitee.com/evanxlh/Resources/raw/master/blog/ios-app-resigning/provisioning-profile.jpg" alt="AppStore Provisioning Profile" style="zoom:50%;" /></p>
<h3 id="CodeResources"><a href="#CodeResources" class="headerlink" title="CodeResources"></a>CodeResources</h3><p><I>CodeResources</I> æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ Plist æ–‡ä»¶ï¼Œ<I>bundle</I> ä¸­çš„æ¯ä¸ªèµ„æºæ–‡ä»¶çš„åŠ å¯†<a href="###ä¿¡æ¯æ‘˜è¦">ä¿¡æ¯æ‘˜è¦</a>éƒ½è®°å½•åœ¨è¿™ä¸ª <I>Plist</I> æ–‡ä»¶ä¸­ã€‚é™¤äº†è¿™äº›åŠ å¯†ä¿¡æ¯æ‘˜è¦ä»¥å¤–ï¼Œå®ƒè¿˜åŒ…æ‹¬ä¸€äº›ç­¾åè§„åˆ™ï¼Œå¯ç”¨äºæ¥æ”¶ç«¯è¿›è¡Œç­¾åéªŒè¯ã€‚ä¸‹å›¾ä¸º <I>CodeResources</I> æ–‡ä»¶æ‰€åŒ…å«çš„å†…å®¹ï¼š</p>
<p><img src="https://gitee.com/evanxlh/Resources/raw/master/blog/ios-app-resigning/code-resource.png" alt="CodeResources" style="zoom:60%;" /></p>
<h3 id="App-ç­¾å"><a href="#App-ç­¾å" class="headerlink" title="App ç­¾å"></a>App ç­¾å</h3><p>å¤§å¤šæ•°æ—¶å€™ï¼ŒXcodeå¯ä»¥å¸®æˆ‘ä»¬è‡ªåŠ¨å®Œæˆæ‰€æœ‰çš„ç­¾åæ“ä½œã€‚ä½†å¦‚æœæ˜¯æ‰‹åŠ¨æ¥ç­¾åçš„è¯ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ Apple æä¾›çš„  <code>codesign</code> ç¨‹åºæ¥ç­¾åã€‚<code>codesign</code> çš„ç­¾åè§„åˆ™å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>codesign</code> å¯ä»¥ç›´æ¥ç»™ä¸€ä¸ª <em>Bundle</em> è¿›è¡Œç­¾åï¼Œè¿™é‡Œçš„ <em>Bundle</em> å¯ä»¥æ˜¯ <em>app bundle (.app)</em> ï¼Œ<em>framework bundle (.framework)</em>ï¼Œ<em>dynamic library (.dylib)</em> ç­‰ã€‚</li>
<li>å®ƒé‡‡ç”¨é€’å½’ç­–ç•¥å¯¹ <code>Bundle</code> ä¸‹çš„æ¯ä¸ªæ–‡ä»¶è¿›è¡Œç­¾åã€‚<code>Bundle</code> å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚</li>
<li>å¯æ‰§è¡Œæ–‡ä»¶çš„åŠ å¯†ä¿¡æ¯æ‘˜è¦ä¼šè¢«ç›´æ¥å†™å…¥å¯æ‰§è¡Œæ–‡ä»¶çš„æœ¬èº«ã€‚è¿™é‡Œè¯´çš„å¯æ‰§è¡Œæ–‡ä»¶å¯ä»¥æ˜¯ executable, Mach-O æ–‡ä»¶ç±»å‹ï¼Œæ¯”å¦‚ app çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œframework ä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</li>
<li>å…ˆä»æœ€åº•å±‚ <code>Bundle</code> ï¼Œå†ç­¾ä¸Šå±‚ <code>Bundle</code>ã€‚æ¯”å¦‚å…ˆç­¾ <em>app bundle</em> ä¸­çš„å†…åµŒçš„æ¯ä¸ª <em>framework bundle</em> ï¼Œç„¶åç­¾ <em>app bundle</em>ã€‚</li>
</ul>
<p><img src="https://gitee.com/evanxlh/Resources/raw/master/blog/ios-app-resigning/ios-app-code-signing.png" style="zoom:40%;" /></p>
<p>ä¸Šå›¾ä¸º iOS app ä»£ç ç­¾åçš„æ¦‚è§ˆå›¾ï¼Œç°åœ¨æˆ‘ä»¬ç»“åˆè¿™å¼ å›¾æ¥ä»‹ç» app çš„ç­¾åæµç¨‹ã€‚</p>
<ul>
<li><p>å‡†å¤‡å¥½ç­¾åè¦ç”¨åˆ°çš„æ‰€æœ‰èµ„æºï¼š<em>ipa</em> æˆ– <em>xcarchive</em>ï¼Œprovisioning profileï¼Œç­¾åè¯ä¹¦ã€‚</p>
</li>
<li><p>å°† App ä¸­çš„å„ç±»ä»£ç æ–‡ä»¶(å¦‚åº“ã€å¯æ‰§è¡Œæ–‡ä»¶ã€è„šæœ¬ã€èµ„æºæ–‡ä»¶ï¼Œä»¥åŠå…¶ä»–ä¸€äº›åƒä»£ç çš„æ•°æ®)æŒ‰ç…§<a href="###æ•°å­—ç­¾åè¿‡ç¨‹">æ•°å­—ç­¾åè¿‡ç¨‹</a>å¹¶ç»“åˆç­¾åè§„åˆ™è¿›è¡Œç­¾åï¼Œå¹¶æŠŠç­¾åå¾—åˆ°çš„ encryted seal è®°å½•åœ¨ CodeResource æ–‡ä»¶ä¸­ã€‚å¯æ‰§è¡Œæ–‡ä»¶ (Mach-Oæ–‡ä»¶) çš„ encryted seal ä¸ä¼šè®°å½•åœ¨ CodeResourceï¼Œ è€Œæ˜¯ç›´æ¥å†™å…¥å¯æ‰§è¡Œæ–‡ä»¶æœ¬èº«ã€‚</p>
</li>
<li><p>ç­¾å®Œååï¼Œé‡æ–°æ‰“åŒ… IPAã€‚</p>
</li>
</ul>
<h2 id="App-é‡ç­¾åå®æˆ˜-â˜…"><a href="#App-é‡ç­¾åå®æˆ˜-â˜…" class="headerlink" title="App é‡ç­¾åå®æˆ˜ â˜…"></a>App é‡ç­¾åå®æˆ˜ <font color=red>â˜…</font></h2><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç”¨è‹¹æœæä¾›çš„å‘½ä»¤è¡Œç¨‹åº <code>codesign</code> æ¥å®ç°æ‰‹åŠ¨ç­¾åã€‚å¦‚æƒ³äº†è§£ <code>codesign</code> å‘½ä»¤çš„å…·ä½“ç”¨æ³•ï¼Œå¯ä»¥æŸ¥çœ‹<a href="https://developer.apple.com/library/archive/documentation/Security/Conceptual/CodeSigningGuide/Procedures/Procedures.html#//apple_ref/doc/uid/TP40005929-CH4-SW2" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>çš„ <I>Signing Code Manually</I> å°èŠ‚ã€‚</p>
<h3 id="é‡ç­¾åç¯å¢ƒ"><a href="#é‡ç­¾åç¯å¢ƒ" class="headerlink" title="é‡ç­¾åç¯å¢ƒ"></a>é‡ç­¾åç¯å¢ƒ</h3><ul>
<li>MacOS: 10.15.4 </li>
<li>Xcode: version 11.5 </li>
</ul>
<h3 id="App-é‡ç­¾åå‚æ•°é…ç½®æ–‡ä»¶"><a href="#App-é‡ç­¾åå‚æ•°é…ç½®æ–‡ä»¶" class="headerlink" title="App é‡ç­¾åå‚æ•°é…ç½®æ–‡ä»¶"></a>App é‡ç­¾åå‚æ•°é…ç½®æ–‡ä»¶</h3><p>App é‡ç­¾åéœ€è¦æä¾›ä¸€äº›å‚æ•°ï¼Œæˆ‘ä»¬æŠŠè¿™äº›å‚æ•°éƒ½é›†ä¸­æ”¾åˆ°è¿™ä¸ª<a href="https://gitee.com/evanxlh/MyComputerToolkit/raw/master/Shells/ios-app-resigning/resigning-params-configuration.plist" target="_blank" rel="noopener">å‚æ•°é…ç½®æ–‡ä»¶</a>ä¸­ã€‚ä»¥ä¸‹ä¸ºå‚æ•°åˆ—è¡¨ï¼š</p>
<ul>
<li><p><strong>RootWorkingDirectory</strong> (å¿…é¡»)<br>Shell è„šæœ¬å·¥ä½œçš„æ ¹ç›®å½•ï¼Œ<em>.ipa</em> æˆ– <em>.xcarchive</em>ï¼Œprovisioning profile å¿…éœ€æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ã€‚ <em>.ipa</em> æˆ–è€… <em>.xcarchive</em>ï¼Œä¸¤è€…ä¸èƒ½åŒæ—¶å­˜åœ¨ã€‚</p>
</li>
<li><p><strong>SignIdentity</strong> (å¿…é¡»)<br>ç­¾åç”¨çš„èº«ä»½ä¿¡æ¯ï¼Œå¯ä»¥åœ¨å‘½ä»¤æ§åˆ¶å°ç»ˆç«¯è¾“å…¥ <code>security find-identity</code> ï¼Œåˆ—å‡º KeyChain Access ä¸­çš„æ‰€æœ‰ <em>identities</em>ï¼Œç„¶åé€‰æ‹©ä½ è¦ç”¨çš„ <em>identity</em>.</p>
</li>
<li><p><strong>NewNameForIPA</strong> (å¯é€‰)<br>é‡ç­¾ååè¾“å‡ºçš„ <em>ipa</em> æ–‡ä»¶åï¼Œä¸åŒ…æ‹¬ <em>.ipa</em> åç¼€ã€‚ä¸æä¾›åˆ™ä½¿ç”¨é»˜è®¤åã€‚</p>
</li>
<li><p><strong>AppleID &amp; AppleIDPassword</strong>  (å¯é€‰)<br>Apple ID å’Œ password å¯é€‰ã€‚å¦‚æœæä¾›ï¼Œå¯ä»¥å°†é‡ç­¾åå¥½çš„ <em>ipa</em> ç›´æ¥ä¸Šä¼ åˆ° iTunes Connectã€‚</p>
</li>
</ul>
<p>æ‰€ä»¥åœ¨å¼€å§‹ç­¾åå‰ï¼Œä½ çš„å·¥ä½œç›®å½•å¤§æ¦‚æ˜¯è¿™æ ·ï¼Œä¸è¿‡ è„šæœ¬æ–‡ä»¶éšä¾¿æ”¾å“ªéƒ½è¡Œï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>é‡ç­¾å ipa çš„å·¥ä½œç›®å½•</th>
<th>é‡ç­¾å xcarchive çš„å·¥ä½œç›®å½•</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="https://gitee.com/evanxlh/Resources/raw/master/blog/ios-app-resigning/root-working-dir-ipa.png" alt="Working Directory" style="zoom:67%;" /></td>
<td><img src="https://gitee.com/evanxlh/Resources/raw/master/blog/ios-app-resigning/root-working-dir-xcarchive.png" alt="xcarchive working directory" style="zoom:67%;" /></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Shell-è„šæœ¬é‡ç­¾å"><a href="#Shell-è„šæœ¬é‡ç­¾å" class="headerlink" title="Shell è„šæœ¬é‡ç­¾å"></a>Shell è„šæœ¬é‡ç­¾å</h3><p>Shell è„šæœ¬ç­¾ååˆ†ä¸º 10 ä¸ªæ­¥éª¤ï¼Œ10 ä¸ªæ­¥éª¤éœ€è¦æŒ‰ç…§å…ˆåé¡ºåºæ‰§è¡Œï¼Œ ä½ ä¹Ÿå¯ä»¥åœ¨ç›´æ¥æŸ¥çœ‹<a href="https://gitee.com/evanxlh/MyComputerToolkit/raw/master/Shells/ios-app-resigning/ios-app-resigning.sh" target="_blank" rel="noopener">å®Œæ•´çš„ shell è„šæœ¬</a>ã€‚<font color=red>è„šæœ¬è¦æ±‚æ‰€æœ‰è·¯å¾„ä¸­ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œæ‰€ä»¥è¯·æ³¨æ„æ‚¨ App ä¸­çš„æ‰€æœ‰æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹åéƒ½ä¸èƒ½å¸¦ç©ºæ ¼ã€‚</font></p>
<h4 id="1-è¯»å–é‡ç­¾åå‚æ•°é…ç½®æ–‡ä»¶"><a href="#1-è¯»å–é‡ç­¾åå‚æ•°é…ç½®æ–‡ä»¶" class="headerlink" title="1. è¯»å–é‡ç­¾åå‚æ•°é…ç½®æ–‡ä»¶"></a>1. è¯»å–é‡ç­¾åå‚æ•°é…ç½®æ–‡ä»¶</h4><p>æ‰§è¡Œè„šæœ¬åï¼Œç»ˆç«¯ä¼šæç¤ºä½ å°†é‡ç­¾åç”¨çš„å‚æ•°é…ç½®æ–‡ä»¶æ‹–åˆ°æ§åˆ¶å°(è¿™æ ·å°±å¯ä»¥å¾—åˆ°æ–‡ä»¶çš„ç»å¯¹è·¯å¾„)ã€‚<a href="https://gitee.com/evanxlh/MyComputerToolkit/raw/master/Shells/ios-app-resigning/resigning-params-configuration.plist" target="_blank" rel="noopener">ç‚¹æˆ‘è·å–å‚æ•°é…ç½®çš„æ ·ä¾‹æ–‡ä»¶</a>ã€‚</p>
<p><img src="https://gitee.com/evanxlh/Resources/raw/master/blog/ios-app-resigning/resigning-params.png" alt="Read resigning params" style="zoom:67%;" />   </p>
<h4 id="2-å‡†å¤‡éœ€è¦é‡ç­¾åçš„-app"><a href="#2-å‡†å¤‡éœ€è¦é‡ç­¾åçš„-app" class="headerlink" title="2. å‡†å¤‡éœ€è¦é‡ç­¾åçš„ app"></a>2. å‡†å¤‡éœ€è¦é‡ç­¾åçš„ app</h4><p>è„šæœ¬æ”¯æŒå¯¹ <em>ipa, xcarchive</em> ä¸¤ç§åŒ…ç±»å‹è¿›è¡Œé‡ç­¾åã€‚å¦‚æœæ˜¯ <em>ipa</em>ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå°†å…¶è§£å‹ï¼›å¦‚æœæ˜¯ <em>xcarchive</em>ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±åˆ›å»º <strong>IPA</strong> çš„å†…å®¹ç›®å½•ç»“æ„ï¼Œå¹¶å°† <em>xcarchive</em> é‡Œé¢çš„ <em>app bundle</em> æ‹·è´åˆ°åˆ›å»ºçš„ <em>Payload</em> ç›®å½•ä¸­å»ã€‚å¦‚æœ Xcode å·¥ç¨‹å¼€å¯ <code>EMBEDDED_CONTENT_CONTAINS_SWIFT</code>ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°† <em>SwiftSupport</em> æ”¾å…¥ <strong>IPA</strong>ã€‚ </p>
<p><img src="https://gitee.com/evanxlh/Resources/raw/master/blog/ios-app-resigning/embed-swift-standard-libraries.png" style="zoom:67%;" /> </p>
<p>æœ€å <strong>IPA</strong> ä¸­çš„å†…å®¹å°±å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆSwiftSupport éœ€è§†å®é™…æƒ…å†µæ¥å†³å®šï¼‰ï¼š</p>
<p><img src="https://gitee.com/evanxlh/Resources/raw/master/blog/ios-app-resigning/ipa-contents.png" alt="App Contents" style="zoom:67%;" /> </p>
<h4 id="3-åˆ é™¤åŸæœ‰çš„-CodeSignature-ç›®å½•"><a href="#3-åˆ é™¤åŸæœ‰çš„-CodeSignature-ç›®å½•" class="headerlink" title="3. åˆ é™¤åŸæœ‰çš„ _CodeSignature ç›®å½•"></a>3. åˆ é™¤åŸæœ‰çš„ _CodeSignature ç›®å½•</h4><p>å…ˆé€’å½’æŸ¥æ‰¾ <em>app bundle</em> ä¸­æ‰€æœ‰çš„ <code>_CodeSignature</code> ç›®å½•ï¼Œç„¶åå°†å®ƒä»¬é€ä¸€åˆ é™¤ã€‚<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">oldSignatures=`find $app_contents_root_path -name "_CodeSignature"`</span><br><span class="line"></span><br><span class="line">for signature in $oldSignatures; do</span><br><span class="line">  rm -rf $signature</span><br><span class="line">done</span><br></pre></td></tr></table></figure></p>
<h4 id="4-ç”Ÿæˆ-entitlements-plist"><a href="#4-ç”Ÿæˆ-entitlements-plist" class="headerlink" title="4. ç”Ÿæˆ entitlements.plist"></a>4. ç”Ÿæˆ entitlements.plist</h4><p><code>entitlements.plist</code> åœ¨ç­¾å <em>app bundle</em> æ—¶éœ€è¦ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä»æä¾›çš„ <em>Provisioning Profile</em> ä¸­æå–å‡ºç›¸å…³ä¿¡æ¯ï¼Œå¹¶ç”Ÿæˆ <code>entitlements.plist</code>ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ä» Provisioning Profile ä¸­æå–å‡ºæ¥çš„ entitlements ä¿¡æ¯å­˜å‚¨è·¯å¾„</span></span><br><span class="line">entitlements_plist_path="$&#123;root_working_dir_path&#125;/entitlements.plist"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å°† *.mobileprovision æ–‡ä»¶ä¸­çš„ä¿¡æ¯è¾“å‡ºåˆ°ä¸€ä¸ªä¸´æ—¶plist</span></span><br><span class="line">security cms -D -i $new_profile_path &gt; tempProfile.plist</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä»ä¸´æ—¶plistä¸­æå–å‡º entitlements ä¿¡æ¯å¹¶å†™å…¥ entitlements.plist</span></span><br><span class="line">/usr/libexec/PlistBuddy -x -c 'Print :Entitlements' tempProfile.plist &gt; $entitlements_plist_path</span><br></pre></td></tr></table></figure>
<h4 id="5-æ›¿æ¢-Provisioning-Profile"><a href="#5-æ›¿æ¢-Provisioning-Profile" class="headerlink" title="5. æ›¿æ¢ Provisioning Profile"></a>5. æ›¿æ¢ Provisioning Profile</h4><p>å°†æ–°çš„ <em>Provisioning Profile</em> æ‹·è´åˆ° <em>app bundle</em> ä¸­ï¼Œæ›¿æ¢åŸæœ‰çš„ <em>Provisioning Profile</em>ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cp $new_profile_path $app_profile_path</span><br></pre></td></tr></table></figure>
<h4 id="6-æ›¿æ¢-Bundle-ID"><a href="#6-æ›¿æ¢-Bundle-ID" class="headerlink" title="6. æ›¿æ¢ Bundle ID"></a>6. æ›¿æ¢ Bundle ID</h4><p>æ–°çš„ <em>bundle id</em>ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¹‹å‰ç”Ÿæˆçš„ <code>entitlements.plist</code> ä¸­çš„ <em>application-identifier</em>  æå–ï¼Œä½†å®ƒåŒ…å«äº† <em>Team ID</em>, éœ€è¦å°†å…¶ç§»é™¤ã€‚ç„¶åç”¨æ–°çš„ <em>bundle id</em> æ›¿æ¢ <em>app bundle</em> ä¸­çš„ <code>Info.plist</code> ä¸­çš„ <em>bundle id</em>ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> E6ABDGA.com.company.appresignature.test</span></span><br><span class="line">local app_identifier=`/usr/libexec/PlistBuddy -c "Print :application-identifier" $entitlements_plist_path`</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> https://stackoverflow.com/questions/10586153/split-string-into-an-array-in-bash</span></span><br><span class="line">IFS='.' read -r -a components &lt;&lt;&lt; "$&#123;app_identifier&#125;"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Remove `E6ABDGA`: https://askubuntu.com/questions/435996/how-can-i-remove-an-entry-from<span class="_">-a</span>-list-in<span class="_">-a</span>-shells-script</span></span><br><span class="line">unset components[0]</span><br><span class="line">new_bundle_id=`joinStringComponents "." "$&#123;components[@]&#125;"`</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Replace the bundle id <span class="keyword">in</span> Info.plist with new bundle id.</span></span><br><span class="line">plutil -replace CFBundleIdentifier -string $new_bundle_id $app_infoplist_path</span><br></pre></td></tr></table></figure>
<h4 id="7-å¯¹å†…åµŒ-Frameworks-ç­¾å"><a href="#7-å¯¹å†…åµŒ-Frameworks-ç­¾å" class="headerlink" title="7. å¯¹å†…åµŒ Frameworks ç­¾å"></a>7. å¯¹å†…åµŒ Frameworks ç­¾å</h4><p>ä¸‡äº‹ä¿±å¤‡åªæ¬ ä¸œé£ï¼Œæˆ‘ä»¬ç°åœ¨æ­£å¼å¼€å§‹ç­¾åã€‚é¦–å…ˆæ‰¾å‡º <em>app bundle</em> ä¸­çš„å†…åµŒ Frameworks å’ŒåŠ¨æ€åº“ï¼Œç„¶åä½¿ç”¨<a href="###æ•°å­—èº«ä»½">ç­¾åèº«ä»½</a>é€ä¸€è¿›è¡Œç­¾åã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">local frameworks=`find $app_frameworks_path -name "*.framework" -o -name "*.dylib"`</span><br><span class="line"></span><br><span class="line">for framework in $frameworks; do</span><br><span class="line">  codesign -f -s "$&#123;sign_identity&#125;" $framework</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h4 id="8-å¯¹-App-Bundle-ç­¾å"><a href="#8-å¯¹-App-Bundle-ç­¾å" class="headerlink" title="8. å¯¹ App Bundle ç­¾å"></a>8. å¯¹ App Bundle ç­¾å</h4><p>å¯¹ <em>app bundle</em> ç­¾åé™¤äº†éœ€è¦<a href="###æ•°å­—èº«ä»½">ç­¾åèº«ä»½</a>ï¼Œ è¿˜éœ€è¦ä½¿ç”¨ <code>entitlements.plist</code>ã€‚<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">codesign -f -s "$&#123;sign_identity&#125;" --entitlements "$&#123;entitlements_plist_path&#125;" $app_bundle_path</span><br></pre></td></tr></table></figure></p>
<h4 id="9-éªŒè¯ç­¾å"><a href="#9-éªŒè¯ç­¾å" class="headerlink" title="9. éªŒè¯ç­¾å"></a>9. éªŒè¯ç­¾å</h4><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œapp çš„ç­¾åå·¥ä½œå·²å®Œæˆï¼Œç°åœ¨æˆ‘ä»¬æ¥éªŒè¯ç­¾åæ˜¯å¦æœ‰æ•ˆï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">https://developer.apple.com/library/archive/documentation/Security/Conceptual/CodeSigningGuide/Procedures/Procedures.html<span class="comment">#//apple_ref/doc/uid/TP40005929-CH4-SW9</span></span></span><br><span class="line">codesign --verify --deep --strict --verbose=2 $app_bundle_path</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœéªŒè¯å¤±è´¥ï¼Œæ§åˆ¶å°ä¼šè¾“å‡ºè¯¦ç»†çš„é”™è¯¯ã€‚å¦‚æœéªŒè¯æˆåŠŸï¼Œæ§åˆ¶å°ä¼šè¾“å‡º:<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">/path/to/Test.app: valid on disk</span><br><span class="line">/path/to/Test.app: satisfies its Designated Requirement</span><br></pre></td></tr></table></figure></p>
<h4 id="10-åˆ¶ä½œå·²é‡ç­¾åçš„-IPA"><a href="#10-åˆ¶ä½œå·²é‡ç­¾åçš„-IPA" class="headerlink" title="10. åˆ¶ä½œå·²é‡ç­¾åçš„ IPA"></a>10. åˆ¶ä½œå·²é‡ç­¾åçš„ IPA</h4><p>ç­¾åéªŒè¯ä¹ŸæˆåŠŸäº†ï¼Œæœ€åæˆ‘ä»¬å°†æ‰€æœ‰çš„ App å†…å®¹é‡æ–°å‹ç¼©æˆ <em>.ipa</em> æ–‡ä»¶ï¼Œç„¶åè¾“å‡ºåˆ°æŒ‡å®šç›®å½•(ResignedIPAsç›®å½•)ã€‚åœ¨å‹ç¼©æ–‡ä»¶æ—¶ï¼Œæ³¨æ„è¦å¿½ç•¥ <code>.DS_Store</code>ã€‚<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">local root_content_names=`ls $app_contents_root_path`</span><br><span class="line">local contents_will_zipped=""</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ—å‡º app contents æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰å†…å®¹</span></span><br><span class="line">for name in $root_content_names; do</span><br><span class="line">  contents_will_zipped+="$name "</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">cd $app_contents_root_path</span><br><span class="line">zip -qr $new_ipa_name $contents_will_zipped -x "*.DS_Store"</span><br><span class="line">mv $new_ipa_name $ipa_output_directory</span><br></pre></td></tr></table></figure></p>
<h4 id="11-ä¸Šä¼ è‡³-iTunes-Connect-å¯é€‰"><a href="#11-ä¸Šä¼ è‡³-iTunes-Connect-å¯é€‰" class="headerlink" title="11. ä¸Šä¼ è‡³ iTunes Connect (å¯é€‰)"></a>11. ä¸Šä¼ è‡³ iTunes Connect (å¯é€‰)</h4><p>è¿™ä¸€æ­¥ä¸ºå¯é€‰çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†é‡ç­¾åçš„ <em>ipa</em> ç›´æ¥é€šè¿‡å‘½ä»¤è¡Œä¸Šä¼ è‡³ iTunes Connectã€‚å¦‚æœåœ¨é‡ç­¾åå‚æ•°é…ç½®æ–‡ä»¶ä¸­æœ‰å¡«å†™ <em>Apple ID</em> å’Œ <em>Apple ID Password</em>ï¼ŒShell è„šæœ¬å°†æ‰§è¡Œè¿™ä¸€æ­¥ã€‚<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">xcrun altool --upload-app -f $reigned_ipa_path -t iOS -u $apple_id -p $apple_id_password</span><br></pre></td></tr></table></figure></p>
<h3 id="å¸¸è§é”™è¯¯è§£å†³"><a href="#å¸¸è§é”™è¯¯è§£å†³" class="headerlink" title="å¸¸è§é”™è¯¯è§£å†³"></a>å¸¸è§é”™è¯¯è§£å†³</h3><p>å¸¸è§çš„ç­¾åé”™è¯¯ä½ éƒ½å¯ä»¥åœ¨è¿™ä¸¤ä¸ªåœ°æ–¹æ‰¾åˆ° <a href="https://developer.apple.com/library/archive/technotes/tn2318/_index.html" target="_blank" rel="noopener">Troubleshooting Failed Signature Verification</a> ï¼Œ<a href="https://developer.apple.com/library/archive/technotes/tn2415/_index.html" target="_blank" rel="noopener">Entitlements Troubleshooting</a></p>
<h3 id="è„šæœ¬åŠå‚æ•°é…ç½®æ–‡ä»¶è·å–"><a href="#è„šæœ¬åŠå‚æ•°é…ç½®æ–‡ä»¶è·å–" class="headerlink" title="è„šæœ¬åŠå‚æ•°é…ç½®æ–‡ä»¶è·å–"></a>è„šæœ¬åŠå‚æ•°é…ç½®æ–‡ä»¶è·å–</h3><p>ä»¥ä¸‹æ˜¯å®Œæ•´çš„é‡ç­¾å shell è„šæœ¬å’Œå‚æ•°é…ç½®æ–‡ä»¶ï¼š<br><a href="https://gitee.com/evanxlh/MyComputerToolkit/raw/master/Shells/ios-app-resigning/ios-app-resigning.sh" target="_blank" rel="noopener">ios-app-resigning.sh</a><br><a href="https://gitee.com/evanxlh/MyComputerToolkit/raw/master/Shells/ios-app-resigning/resigning-params-configuration.plist" target="_blank" rel="noopener">resigning-params-configuration.plist</a><br>å†™äº†è¿™ä¹ˆä¹…ï¼Œæ€»ç®—å®Œæˆäº†ã€‚å¯ä»¥å¥½å¥½ä¼‘æ¯ä¸‹äº†ï¼ğŸ¹</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://en.wikipedia.org/wiki/Public-key_cryptography" target="_blank" rel="noopener">Asymmetric Cryptography</a><br><a href="https://developer.apple.com/library/archive/documentation/Security/Conceptual/CodeSigningGuide/Introduction/Introduction.html" target="_blank" rel="noopener">Code Signing Guide</a><br><a href="https://developer.apple.com/library/archive/documentation/Security/Conceptual/cryptoservices/Introduction/Introduction.html#//apple_ref/doc/uid/TP40011172-CH1-SW1" target="_blank" rel="noopener">Cryptographic Services Guide</a><br><a href="https://developer.apple.com/library/archive/documentation/Security/Conceptual/Security_Overview/Introduction/Introduction.html#//apple_ref/doc/uid/TP30000976-CH1-SW1" target="_blank" rel="noopener">Software Security Overview</a><br><a href="https://developer.apple.com/library/archive/technotes/tn2318/_index.html" target="_blank" rel="noopener">Technical Note TN2318: Troubleshooting Failed Signature Verification</a><br><a href="https://developer.apple.com/library/archive/technotes/tn2415/_index.html" target="_blank" rel="noopener">Technical Note TN2415: Entitlements Troubleshooting</a></p>

                
                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2020/06/14/make-frameworks-using-xcode/" data-toggle="tooltip" data-placement="top" title="Xcode åˆ¶ä½œ Framework & XCFramework">&larr; ä¸Šä¸€ç¯‡</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2020/04/27/app-multi-environments/" data-toggle="tooltip" data-placement="top" title="Appå¤šç¯å¢ƒé…ç½®æ¢ç´¢">ä¸‹ä¸€ç¯‡ &rarr;</a>
                    </li>
                    
                </ul>

                <!-- tip start -->
                

                
                <div class="comment_notes">
                    <p>
                        å¦‚æœæ‚¨å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œæˆ–è§‰å¾—å¯¹æ‚¨æœ‰ç”¨çš„è¯ï¼Œæ¬¢è¿å‘è¡¨è¯„è®ºï¼Œæ‚¨ä¹Ÿå¯ä»¥éšæ„çš„åˆ†äº«æˆ–è½¬è½½è¿™ç¯‡æ–‡ç« ã€‚å¦‚æœæ–‡ç« ä¸­çš„å›¾ç‰‡æœ‰ä¾µçŠ¯æ‚¨çš„ç‰ˆæœ¬ï¼Œè¯·è”ç³»ä½œè€…å°†æœŸåˆ é™¤ã€‚è°¢è°¢æ‚¨çš„æ”¯æŒï¼
                    </p>
                </div>
                
                <!-- tip end -->

                <!-- Music start-->
                
                
<link rel="stylesheet" href="/css/music-player/fonts/iconfont.css">


<link rel="stylesheet" href="/css/music-player/css/reset.css">


<link rel="stylesheet" href="/css/music-player/css/player.css">


<div class="music-player">
    <audio class="music-player__audio" ></audio>
    <div class="music-player__main">
        <div class="music-player__blur"></div>
        <div class="music-player__disc">
            <div class="music-player__image">
                <img width="100%" src="" alt="">
            </div>
            <div class="music-player__pointer"><img width="100%" src="/img/cd_tou.png" alt=""></div>
        </div>
        <div class="music-player__controls">
            <div class="music__info">
                <h3 class="music__info--title">...</h3>
                <p class="music__info--singer">...</p>
            </div>
            <div class="player-control">
                <div class="player-control__content">
                    <div class="player-control__btns">
                        <div class="player-control__btn player-control__btn--prev"><i class="iconfont icon-prev"></i></div>
                        <div class="player-control__btn player-control__btn--play"><i class="iconfont icon-play"></i></div>
                        <div class="player-control__btn player-control__btn--next"><i class="iconfont icon-next"></i></div>
                        <div class="player-control__btn player-control__btn--mode"><i class="iconfont icon-loop"></i></div>
                    </div>
                    <div class="player-control__volume">
                        <div class="control__volume--icon player-control__btn"><i class="iconfont icon-volume"></i></div>
                        <div class="control__volume--progress player_progress"></div>
                    </div>
                </div>
                <div class="player-control__content">
                    <div class="player__song--progress player_progress"></div>
                    <div class="player__song--timeProgess nowTime">00:00</div>
                    <div class="player__song--timeProgess totalTime">00:00</div>
                </div>
            </div>
        </div>
    </div>
</div>


<script src="/js/music-player/utill.js"></script>


<script src="/js/music-player/jquery.min.js"></script>


<script src="/js/music-player/player.js"></script>


                
                <!-- Music end -->

                <!-- Sharing -->
                
                <div class="social-share"  data-wechat-qrcode-helper="" align="center"></div>
                <!--  css & js -->
                <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
                <script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
                
                <!-- Sharing -->

                <!-- gitment start -->
                
                <hr>
                <div id="blog_comments"></div>

<!--
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
-->
<!--
<link rel="stylesheet" href="/css/gitment.css">
<script type="text/javascript" src="/js/gitment.js"></script>
-->

<script src="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/gitment.browser.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/default.css"/>

<!--
<link rel="stylesheet" href="https://billts.site/extra_css/gitment.css">
<script src="https://billts.site/js/gitment.js"></script>
-->

<script>
const myTheme = {
  render(state, instance) {
    const container = document.createElement('div')
    container.lang = "en-US"
    container.className = 'gitment-container gitment-root-container'
    
     // your custom component
    container.appendChild(instance.renderSomething(state, instance))
    
    container.appendChild(instance.renderHeader(state, instance))
    container.appendChild(instance.renderComments(state, instance))
    container.appendChild(instance.renderEditor(state, instance))
    //container.appendChild(instance.renderFooter(state, instance))
    return container
  },
  renderSomething(state, instance) {
    const container = document.createElement('div')
    container.lang = "en-US"
    container.className = 'hello_visitor'
    if (state.user.login) {
      container.innerText = `Hello ${state.user.login}, Welcome to comment system`
    }
    return container
  }
}
const gitment = new Gitment({
    id: 'Thu May 28 2020 23:17:26 GMT+0800', // optional
    owner: "evanxlh",
    repo: "MyBlogComments",
    oauth: {
      client_id: "a60bad854ffd3940e9ba",
      client_secret: "8d4899954d7d7ae91ac24b524385b5272bdb9d05",
    },
    theme: myTheme,
    // ...
    // For more available options, check out the documentation below
  })
  
  gitment.render('blog_comments')
  // or
  // gitment.render(document.getElementById('comments'))
  // or
  // document.body.appendChild(gitment.render())
</script>
                
                <!-- gitment end -->

                <!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  -->
                
                <!-- Cityç‰ˆå®‰è£…ä»£ç å·²å®Œæˆ -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->
            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

    
      
        <aside id="sidebar">
          <div id="toc" class="toc-article">
          <strong class="toc-title">Contents</strong>
          
            
              <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#iOS-app-é‡ç­¾ååŠå‘å¸ƒè‡³-AppStore"><span class="toc-nav-text">iOS app é‡ç­¾ååŠå‘å¸ƒè‡³ AppStore</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#æ ¸å¿ƒæ¦‚å¿µ"><span class="toc-nav-text">æ ¸å¿ƒæ¦‚å¿µ</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#åŠ å¯†å“ˆå¸Œå‡½æ•°"><span class="toc-nav-text">åŠ å¯†å“ˆå¸Œå‡½æ•°</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#éå¯¹ç§°åŠ å¯†"><span class="toc-nav-text">éå¯¹ç§°åŠ å¯†</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#ä¿¡æ¯æ‘˜è¦"><span class="toc-nav-text">ä¿¡æ¯æ‘˜è¦</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#æ•°å­—è¯ä¹¦"><span class="toc-nav-text">æ•°å­—è¯ä¹¦</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#æ•°å­—èº«ä»½"><span class="toc-nav-text">æ•°å­—èº«ä»½</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#è¯ä¹¦é¢å‘æœºæ„"><span class="toc-nav-text">è¯ä¹¦é¢å‘æœºæ„</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#æ•°å­—ç­¾å"><span class="toc-nav-text">æ•°å­—ç­¾å</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#è§„èŒƒè¦æ±‚"><span class="toc-nav-text">è§„èŒƒè¦æ±‚</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#æ•°å­—ç­¾ååŸç†"><span class="toc-nav-text">æ•°å­—ç­¾ååŸç†</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#æ•°å­—ç­¾åè¿‡ç¨‹"><span class="toc-nav-text">æ•°å­—ç­¾åè¿‡ç¨‹</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#éªŒè¯æ•°å­—ç­¾åè¿‡ç¨‹"><span class="toc-nav-text">éªŒè¯æ•°å­—ç­¾åè¿‡ç¨‹</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#iOS-App-ä»£ç ç­¾å"><span class="toc-nav-text">iOS App ä»£ç ç­¾å</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#éœ€è¦å¯¹å“ªäº›æ–‡ä»¶ç­¾å"><span class="toc-nav-text">éœ€è¦å¯¹å“ªäº›æ–‡ä»¶ç­¾å</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Entitlements"><span class="toc-nav-text">Entitlements</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Provisioning-Profile"><span class="toc-nav-text">Provisioning Profile</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#CodeResources"><span class="toc-nav-text">CodeResources</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#App-ç­¾å"><span class="toc-nav-text">App ç­¾å</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#App-é‡ç­¾åå®æˆ˜-â˜…"><span class="toc-nav-text">App é‡ç­¾åå®æˆ˜ â˜…</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#é‡ç­¾åç¯å¢ƒ"><span class="toc-nav-text">é‡ç­¾åç¯å¢ƒ</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#App-é‡ç­¾åå‚æ•°é…ç½®æ–‡ä»¶"><span class="toc-nav-text">App é‡ç­¾åå‚æ•°é…ç½®æ–‡ä»¶</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Shell-è„šæœ¬é‡ç­¾å"><span class="toc-nav-text">Shell è„šæœ¬é‡ç­¾å</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#1-è¯»å–é‡ç­¾åå‚æ•°é…ç½®æ–‡ä»¶"><span class="toc-nav-text">1. è¯»å–é‡ç­¾åå‚æ•°é…ç½®æ–‡ä»¶</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#2-å‡†å¤‡éœ€è¦é‡ç­¾åçš„-app"><span class="toc-nav-text">2. å‡†å¤‡éœ€è¦é‡ç­¾åçš„ app</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#3-åˆ é™¤åŸæœ‰çš„-CodeSignature-ç›®å½•"><span class="toc-nav-text">3. åˆ é™¤åŸæœ‰çš„ _CodeSignature ç›®å½•</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#4-ç”Ÿæˆ-entitlements-plist"><span class="toc-nav-text">4. ç”Ÿæˆ entitlements.plist</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#5-æ›¿æ¢-Provisioning-Profile"><span class="toc-nav-text">5. æ›¿æ¢ Provisioning Profile</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#6-æ›¿æ¢-Bundle-ID"><span class="toc-nav-text">6. æ›¿æ¢ Bundle ID</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#7-å¯¹å†…åµŒ-Frameworks-ç­¾å"><span class="toc-nav-text">7. å¯¹å†…åµŒ Frameworks ç­¾å</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#8-å¯¹-App-Bundle-ç­¾å"><span class="toc-nav-text">8. å¯¹ App Bundle ç­¾å</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#9-éªŒè¯ç­¾å"><span class="toc-nav-text">9. éªŒè¯ç­¾å</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#10-åˆ¶ä½œå·²é‡ç­¾åçš„-IPA"><span class="toc-nav-text">10. åˆ¶ä½œå·²é‡ç­¾åçš„ IPA</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#11-ä¸Šä¼ è‡³-iTunes-Connect-å¯é€‰"><span class="toc-nav-text">11. ä¸Šä¼ è‡³ iTunes Connect (å¯é€‰)</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#å¸¸è§é”™è¯¯è§£å†³"><span class="toc-nav-text">å¸¸è§é”™è¯¯è§£å†³</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#è„šæœ¬åŠå‚æ•°é…ç½®æ–‡ä»¶è·å–"><span class="toc-nav-text">è„šæœ¬åŠå‚æ•°é…ç½®æ–‡ä»¶è·å–</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#å‚è€ƒèµ„æ–™"><span class="toc-nav-text">å‚è€ƒèµ„æ–™</span></a></li></ol></li></ol>
            
          
          </div>
        </aside>
      
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">ç‰¹è‰²æ ‡ç­¾</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#Appæ„å»ºä¸å‘å¸ƒ" title="Appæ„å»ºä¸å‘å¸ƒ">Appæ„å»ºä¸å‘å¸ƒ</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>å‹æƒ…é“¾æ¥</h5>
                <ul class="list-inline">

                    
                        <li><a href="https://github.com/evanxlh" target="_blank">æˆ‘çš„Github</a></li>
                    
                        <li><a href="https://gitee.com/evanxlh" target="_blank">æˆ‘çš„Gitee</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'â„¬'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>


<style  type="text/css">
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">

                
                    <li>
                        <a target="_blank"  href="https://github.com/evanxlh">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                

                

                

                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; evanxlh 2020 
                    <br>
                    Powered by 
                    <a href="https://github.com/dusign/hexo-theme-snail" target="_blank" rel="noopener">
                        <i>hexo-theme-snail</i>
                    </a> | 
                    <iframe name="star" style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0"
                        width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=dusign&repo=hexo-theme-snail&type=star&count=true">
                    </iframe>
                </p>
            </div>
        </div>
    </div>

</footer>

<!-- jQuery -->

<script src="/js/jquery.min.js"></script>


<!-- Bootstrap Core JavaScript -->

<script src="/js/bootstrap.min.js"></script>


<!-- Custom Theme JavaScript -->

<script src="/js/hux-blog.min.js"></script>


<!-- Search -->

<script src="/js/search.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://evanxlh.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->




<!-- Baidu Tongji -->


<!-- Search -->

    <script type="text/javascript">      
        var search_path = "search.xml";
        if (search_path.length == 0) {
            search_path = "search.xml";
        }
    var path = "/" + search_path;
    searchFunc(path, 'local-search-input', 'local-search-result');
    </script>


<!-- busuanzi -->
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>

    
        <!-- background effects line -->
        

        
            <script type="text/javascript" src="/js/mouse-click.js" content='[&#34;ğŸŒ±&#34;,&#34;ğŸ€&#34;, &#34;ğŸ&#34;,&#34;â¤ï¸&#34;,&#34;ğŸ’–&#34;,&#34;ğŸ’&#34;,ğŸ·&#34;,&#34;ğŸŒ·&#34;,&#34;ğŸ¦‹&#34;]' color='[&#34;rgb(121,93,179)&#34; ,&#34;rgb(76,180,231)&#34; ,&#34;rgb(184,90,154)&#34;]'></script>
        

        <!-- background effects end -->
    

    <!--<script size="50" alpha='0.3' zIndex="-999" src="/js/ribbonStatic.js"></script>-->
    
        <script src="/js/ribbonDynamic.js"></script>
    
</body>

</html>
